<header class="header {{ if site.Params.navbar_fixed }}sticky top-0{{ end }} z-30">
  <nav class="navbar container grid grid-cols-5 gap-4">
    <div class="">
      <a class="navbar-brand block" href="{{ site.Home.RelPermalink }}">
        {{ partial "logo" }}
      </a>
    </div>
    <div class="col-span-3">
      <ul id="nav-menu"
        class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 items-center justify-center ">
        {{ $currentPage := . }}
        {{ range site.Menus.main }}
        {{ $menuURL := .URL | absLangURL }}
        {{ $pageURL:= $currentPage.Permalink | absLangURL }}
        {{ $active := eq $menuURL $pageURL }}
        {{ if .HasChildren }}
        <li class="nav-item nav-dropdown group relative">
          <span class="nav-link {{ range .Children }}
                    {{ $childURL := .URL | absLangURL }}
                    {{ $active := eq $childURL $pageURL }}
                    {{ if $active }}active{{ end }}
                  {{ end }} inline-flex items-center">
            {{ .Name }}
            <svg class="h-4 w-4 fill-current" viewBox="0 0 20 20">
              <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
            </svg>
          </span>
          <ul class="nav-dropdown-list lg:group-hover:visible lg:group-hover:opacity-100">
            {{ range .Children }}
            {{ $childURL := .URL | absLangURL }}
            {{ $active := eq $childURL $pageURL }}
            <li class="nav-dropdown-item">
              <a class="nav-dropdown-link {{ if $active }}
                          active
                        {{- end -}}" {{ if findRE `^http` .URL }} target="_blank" rel="noopener" {{ end }} href="{{- if findRE `^#` .URL -}}
                          {{- if not $.IsHome -}}
                            {{- site.Home.RelPermalink -}}
                          {{- end }}
                          {{- .URL -}}
                        {{- else -}}
                          {{- .URL | relLangURL -}}
                        {{- end -}}">
                {{ .Name }}
              </a>
            </li>
            {{ end }}
          </ul>
        </li>
        {{ else }}
        <li class="nav-item">
          <a class="nav-link {{ if $active }}active{{- end -}} " {{ if findRE `^http` .URL }} target="_blank"
            rel="noopener" {{ end }} href="{{- if findRE `^#` .URL -}}
                    {{- if not $.IsHome -}}
                      {{- site.Home.RelPermalink -}}
                    {{- end }}{{- .URL -}}
                  {{- else -}}
                    {{- .URL | relLangURL -}}
                  {{- end -}}">{{ .Name }}</a>
        </li>
        {{ end }}
        {{ end }}
        {{ if site.Params.navigation_button.enable }}
        <li class="mt-4 inline-block lg:hidden">
          <a class="btn btn-outline-primary btn-sm" href="{{ site.Params.navigation_button.link | relLangURL }}">
            {{ site.Params.navigation_button.label }}
          </a>
        </li>
        {{ end }}
      </ul>
    </div>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0 justify-end">
      {{ with site.Params.search }}
      {{ if .enable }}
      <button aria-label="search"
        class="border-border text-dark hover:text-primary dark:border-darkmode-border mr-5 inline-block border-r pr-5 text-xl dark:text-white dark:hover:text-darkmode-primary"
        data-target="search-modal">
        <i class="fa-solid fa-search"></i>
      </button>
      {{ end }}
      {{ end }}





      <button data-theme-switcher id="theme-toggle"
        class="w-8 h-8 bg-dark text-white hover:bg-gray-500 rounded-full flex items-center justify-center dark:bg-white dark:text-dark ">
        <i id="theme-toggle-icon" class="fas fa-moon"></i>
      </button>

      <!-- {{ partial "components/theme-switcher" (dict "Class" "mr-5") }} -->


      <!-- navigation btn -->
      {{ if site.Params.navigation_button.enable }}
      <a href="{{ site.Params.navigation_button.link | relLangURL }}"
        class="btn btn-outline-primary btn-sm hidden lg:inline-block">
        {{ site.Params.navigation_button.label }}
      </a>
      {{ end }}
    </div>




  </nav>


  <script>
    // Sélectionne le bouton et l'icône
    // Sélectionne le bouton et l'icône
    const themeToggleBtn = document.getElementById('theme-toggle');
    const themeToggleIcon = document.getElementById('theme-toggle-icon');

    // Fonction pour basculer le thème et enregistrer l'état
    function toggleTheme() {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        themeToggleIcon.classList.remove('fa-sun');
        themeToggleIcon.classList.add('fa-moon');
        localStorage.setItem('theme', 'light'); // Sauvegarde le thème clair
      } else {
        document.documentElement.classList.add('dark');
        themeToggleIcon.classList.remove('fa-moon');
        themeToggleIcon.classList.add('fa-sun');
        localStorage.setItem('theme', 'dark'); // Sauvegarde le thème sombre
      }
    }

    // Écouteur d'événement pour le bouton de changement de thème
    themeToggleBtn.addEventListener('click', toggleTheme);

    // Fonction pour appliquer le thème basé sur le Local Storage ou les préférences système
    function applyTheme() {
      const storedTheme = localStorage.getItem('theme');
      const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

      if (storedTheme === 'dark' || (!storedTheme && systemPrefersDark)) {
        document.documentElement.classList.add('dark');
        themeToggleIcon.classList.remove('fa-moon');
        themeToggleIcon.classList.add('fa-sun');
      } else {
        document.documentElement.classList.remove('dark');
        themeToggleIcon.classList.remove('fa-sun');
        themeToggleIcon.classList.add('fa-moon');
      }
    }

    // Appliquer le thème au chargement de la page
    applyTheme();

  </script>